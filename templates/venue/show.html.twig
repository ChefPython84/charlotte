{% extends 'base.html.twig' %}

{% block title %}{{ venue.name }}{% endblock %}

{% block body %}
<h1>{{ venue.name }}</h1>

{% if venue.pictures is not empty %}
    <img src="{{ venue.pictures[0] }}" alt="{{ venue.name }}" style="width:400px; height:auto; margin-bottom:20px;">
{% endif %}

<p><strong>Ville :</strong> {{ venue.municipality.name }}</p>
<p><strong>Adresse :</strong> {{ venue.address }}</p>
<p><strong>Capacité :</strong> {{ venue.capacity }} personnes</p>
<p><strong>Prix :</strong> {{ venue.price }} €</p>
<p><strong>Description :</strong> {{ venue.description }}</p>

<h2>Calendrier de réservation</h2>
<div id="calendar" data-venue-id="{{ venue.id }}"style="max-width:900px; margin: 20px auto; height:650px; border:1px solid #ccc; padding:10px;"></div>

<a href="{{ path('venue_index') }}">← Retour au catalogue</a>

<script>
document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');
    if (!calendarEl) return;

    var calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        selectable: true,
        height: 'auto',
        events: '/api/bookings/{{ venue.id }}',  // route API JSON bookings
        select: function(info) {
    let start = info.startStr;
    let end = info.endStr;
    window.location.href = '{{ path("booking_new", {"id": venue.id}) }}?start=' + start + '&end=' + end;
}

    });

    calendar.render();
});
</script>
{% endblock %}
